<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Happy Birthday!</title>

<style>
    body {
        background: #f2f8ff;
        text-align: center;
        font-family: "Comic Sans MS", cursive;
        overflow-x: hidden;
    }

    #cake-container {
        margin-top: 60px;
        position: relative;
        display: inline-block;
    }

    /* Cake */
    #cake {
        width: 260px;
        height: 150px;
        background: linear-gradient(#7ee8ff, #ffb3f4);
        border-radius: 20px;
        padding-top: 40px;
        position: relative;
        border: 4px solid white;
        box-shadow: 0 0 20px #ffcaff;
    }

    /* Bows */
    .bow {
        width: 60px;
        position: absolute;
        top: 10px;
    }
    #bow-left { left: -70px; }
    #bow-right { right: -70px; }

    /* Candles */
    .candle {
        width: 6px;
        height: 35px;
        background: #fff;
        margin: 0 6px;
        display: inline-block;
        position: relative;
        border-radius: 3px;
    }
    .flame {
        width: 10px;
        height: 14px;
        background: radial-gradient(circle, #ffff66, #ff9900);
        border-radius: 50%;
        position: absolute;
        top: -16px;
        left: -2px;
        animation: flicker 0.15s infinite alternate;
    }
    @keyframes flicker {
        0% { transform: translateX(0px) scale(1); }
        100% { transform: translateX(2px) scale(1.1); }
    }

    /* Fade image */
    #final-image {
        margin-top: 40px;
        opacity: 0;
        transition: opacity 1.8s ease;
        width: 90%;
        max-width: 700px;
    }

    /* Confetti */
    .confetti {
        position: fixed;
        top: -10px;
        width: 10px;
        height: 10px;
        background: pink;
        border-radius: 50%;
        animation: fall 3s linear forwards;
        pointer-events: none;
    }
    @keyframes fall {
        to {
            transform: translateY(110vh) rotate(360deg);
            opacity: 0;
        }
    }
</style>
</head>

<body>

<h1 style="color:#7db4ff; font-size:38px; margin-top:20px;">
    Happy Birthday My Love! ðŸŽ‰
</h1>

<div id="cake-container">
    <img id="bow-left" class="bow" src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/5f/Emoji_u1f380.svg/240px-Emoji_u1f380.svg.png">
    <img id="bow-right" class="bow" src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/5f/Emoji_u1f380.svg/240px-Emoji_u1f380.svg.png">

    <div id="cake">
        <div id="candles">
            <div class="candle"><div class="flame"></div></div>
            <div class="candle"><div class="flame"></div></div>
            <div class="candle"><div class="flame"></div></div>
            <div class="candle"><div class="flame"></div></div>
            <div class="candle"><div class="flame"></div></div>
            <div class="candle"><div class="flame"></div></div>
            <div class="candle"><div class="flame"></div></div>
        </div>
    </div>
</div>

<p style="font-size:18px; margin-top:20px; color:#444;">
    Tap the cake or blow to extinguish the candles ðŸŽ‚
</p>

<!-- Final image (your uploaded file) -->
<img id="final-image" src="birthday.png">

<script>
// Candle blow-out + image fade + confetti
function blowOut() {
    document.querySelectorAll(".flame").forEach(f => f.style.display = "none");
    document.getElementById("final-image").style.opacity = 1;
    launchConfetti();
}

// Tap cake
document.getElementById("cake").onclick = blowOut;

// Microphone blow (works only on HTTPS)
if (location.protocol === "https:") {
    navigator.mediaDevices.getUserMedia({ audio: true }).then(stream => {
        const audio = new (window.AudioContext)();
        const mic = audio.createMediaStreamSource(stream);
        const analyser = audio.createAnalyser();
        analyser.fftSize = 512;
        mic.connect(analyser);

        const data = new Uint8Array(analyser.frequencyBinCount);

        function listen() {
            analyser.getByteFrequencyData(data);
            const volume = data.reduce((a,b)=>a+b)/data.length;
            if (volume > 60) blowOut();
            requestAnimationFrame(listen);
        }
        listen();
    });
}

// Confetti
function launchConfetti() {
    for (let i = 0; i < 60; i++) {
        let c = document.createElement("div");
        c.classList.add("confetti");

        c.style.left = Math.random() * 100 + "vw";
        c.style.background = ["#ff99d6","#7ee8ff","#ffd1fb","#b1f2ff"]
            [Math.floor(Math.random() * 4)];
        c.style.animationDuration = (2 + Math.random() * 2) + "s";

        document.body.appendChild(c);
        setTimeout(()=>c.remove(), 4000);
    }
}
</script>

</body>
</html>
